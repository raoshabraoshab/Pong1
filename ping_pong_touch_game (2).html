<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1" />
  <title>Royal Ping Pong — Touch Controls</title>
  <style>
    :root{
      --bg1:#0f0c29; /* royal gradient */
      --bg2:#302b63;
      --bg3:#24243e;
      --fg:#f0f6ff;
      --accent:#ffd369;
    }
    html,body{
      height:100%;margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Arial;background:linear-gradient(135deg,var(--bg1),var(--bg2),var(--bg3));color:var(--fg);overflow:hidden;
    }
    .app{display:flex;flex-direction:column;height:100%;align-items:center;justify-content:flex-start;padding-top:10px}
    canvas{background:rgba(255,255,255,0.05);border-radius:16px;box-shadow:0 12px 40px rgba(0,0,0,.6)}
    .hud{width:100%;max-width:900px;display:flex;justify-content:space-between;align-items:center;margin:12px 0}
    .btn{background:var(--accent);color:#222;padding:8px 14px;border-radius:10px;border:none;cursor:pointer;font-weight:600;box-shadow:0 3px 6px rgba(0,0,0,.4)}
    .btn:hover{opacity:0.85}
    .score{font-weight:700;font-size:20px;color:var(--accent)}

    /* touch controls */
    .touch-pad{width:100%;max-width:900px;display:flex;justify-content:space-between;margin-top:20px}
    .touch-column{display:flex;flex-direction:column;gap:16px;padding:0 20px}
    .touch-button{width:80px;height:80px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:22px;font-weight:700;color:#222;background:var(--accent);box-shadow:0 6px 12px rgba(0,0,0,0.4);user-select:none;touch-action:none;text-align:center;line-height:1.2;padding:6px}
    .touch-button:active{transform:scale(0.9)}
    @media (max-width:600px){
      .touch-button{width:64px;height:64px;font-size:18px}
    }
  </style>
</head>
<body>
  <div class="app">
    <div class="hud">
      <div class="score">Player: <span id="scoreP">0</span> — CPU: <span id="scoreC">0</span></div>
      <div>
        <button id="startBtn" class="btn">▶ Start</button>
        <button id="resetBtn" class="btn">⟳ Reset</button>
      </div>
    </div>

    <canvas id="game" width="900" height="500"></canvas>

    <div class="touch-pad">
      <div class="touch-column">
        <div class="touch-button" id="pBoth">▲▼</div>
      </div>
      <div class="touch-column">
        <div class="touch-button" id="rBoth">▲▼</div>
      </div>
    </div>
  </div>

  <script>
    const canvas = document.getElementById('game');
    const ctx = canvas.getContext('2d');

    const paddleW = 14, paddleH = 90, ballR = 9;
    let player = {x:20,y:(canvas.height-paddleH)/2,w:paddleW,h:paddleH,dy:0};
    let cpu = {x:canvas.width-20-paddleW,y:(canvas.height-paddleH)/2,w:paddleW,h:paddleH,dy:0};
    let ball = {x:canvas.width/2,y:canvas.height/2,vx:5,vy:3,r:ballR};
    let scoreP=0,scoreC=0,running=false;

    function resetBall(dir=1){
      ball.x=canvas.width/2;ball.y=canvas.height/2;
      ball.vx=5*dir;ball.vy=3*(Math.random()>0.5?1:-1);
    }
    function resetGame(){scoreP=0;scoreC=0;updateScore();resetBall(Math.random()>0.5?1:-1);running=false;}

    function updateScore(){document.getElementById('scoreP').textContent=scoreP;document.getElementById('scoreC').textContent=scoreC;}

    function update(){
      if(!running) return;
      player.y+=player.dy;cpu.y+=cpu.dy;
      player.y=Math.max(0,Math.min(canvas.height-player.h,player.y));
      cpu.y=Math.max(0,Math.min(canvas.height-cpu.h,cpu.y));

      ball.x+=ball.vx;ball.y+=ball.vy;
      if(ball.y-ball.r<0||ball.y+ball.r>canvas.height) ball.vy*=-1;

      function collide(p){
        if(ball.x-ball.r<p.x+p.w&&ball.x+ball.r>p.x&&ball.y>p.y&&ball.y<p.y+p.h){
          ball.vx*=-1;
        }
      }
      collide(player);collide(cpu);

      if(ball.x<0){scoreC++;updateScore();resetBall(1);}
      if(ball.x>canvas.width){scoreP++;updateScore();resetBall(-1);}

      if(cpu.dy===0){
        if(ball.y<cpu.y+cpu.h/2) cpu.y-=3;
        if(ball.y>cpu.y+cpu.h/2) cpu.y+=3;
      }
    }

    function draw(){
      ctx.clearRect(0,0,canvas.width,canvas.height);
      ctx.fillStyle=varAccent();
      ctx.fillRect(player.x,player.y,player.w,player.h);
      ctx.fillRect(cpu.x,cpu.y,cpu.w,cpu.h);
      ctx.beginPath();ctx.arc(ball.x,ball.y,ball.r,0,Math.PI*2);ctx.fill();
    }

    function varAccent(){return getComputedStyle(document.documentElement).getPropertyValue('--accent');}

    function loop(){update();draw();requestAnimationFrame(loop);}loop();

    document.getElementById('startBtn').onclick=()=>running=true;
    document.getElementById('resetBtn').onclick=()=>resetGame();

    function bothControl(id,who){
      const el=document.getElementById(id);
      el.addEventListener('touchstart',e=>{e.preventDefault();who.dy=-6;setTimeout(()=>{who.dy=6;},300);});
      el.addEventListener('touchend',e=>{e.preventDefault();who.dy=0;});
      el.addEventListener('pointerdown',e=>{e.preventDefault();who.dy=-6;setTimeout(()=>{who.dy=6;},300);});
      el.addEventListener('pointerup',e=>{e.preventDefault();who.dy=0;});
    }

    bothControl('pBoth',player);
    bothControl('rBoth',cpu);

    resetGame();
  </script>
</body>
</html>
